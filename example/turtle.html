<html>

<head>
  <script src="../dist/skulpt.min.js" type="text/javascript"></script>
  <script src="../dist/skulpt-stdlib.js" type="text/javascript"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</head>

<body>
  <div class="container" style="height: 100%;">
  <div class="row" style="height: 90%;">
    <div class="col-lg">
      <textarea id="code" rows="40" cols="80" >
import turtle
turtle.mode("logo")
turtle.tracer(False)
turtle.shape("turtle")
turtle.colormode(255)

# 画栅栏
def zhalan(x,y,chang,gao):
    turtle.pu()
    turtle.seth(0)
    turtle.goto(x,y)
    turtle.pd()
    turtle.fillcolor(255,255,255)
    turtle.begin_fill()
    turtle.forward(gao)
    turtle.right(90)
    turtle.forward(chang)
    turtle.right(90)
    turtle.forward(gao)
    turtle.right(90)
    turtle.forward(chang)
    turtle.end_fill()


def zhalan_all( ):
    zhalan(-216,-10,130,15)
    zhalan(-216,-40,130,15)
    zhalan(-190,-60,15,80)
    zhalan(-160,-60,15,80)
    zhalan(-130,-60,15,80)


# 画云
def yun(x,y):

    #turtle.bgcolor(0,255,255)

    # 背景，用bgcolor 会闪
    turtle.goto(-480,-60)
    turtle.seth(90)
    turtle.fillcolor(0,255,255)
    turtle.begin_fill()
    turtle.pd()
    turtle.forward(960)
    turtle.left(90)
    turtle.forward(470)
    turtle.left(90)
    turtle.forward(960)
    turtle.left(90)
    turtle.forward(470)
    turtle.end_fill()

    turtle.pu()
    turtle.seth(0)
    turtle.pencolor("white")
    turtle.goto(x,y)
    turtle.fillcolor(255,255,255)
    turtle.begin_fill()
    turtle.pd()
    turtle.circle(30, 90)
    turtle.right(90)
    turtle.circle(30, 180)
    turtle.right(90)
    turtle.circle(30, 90)
    turtle.left(90)
    turtle.goto(x,y)
    turtle.end_fill()
    turtle.pensize(1)



# 画地面
def dimian():
    turtle.pu()
    turtle.seth(0)
    turtle.pensize(0)
    turtle.goto(-480,-60)
    turtle.fillcolor(255,144,48)
    turtle.begin_fill()
    turtle.pd()
    turtle.right(90)
    turtle.forward(960)
    turtle.right(90)
    turtle.forward(340)
    turtle.right(90)
    turtle.forward(960)
    turtle.right(90)
    turtle.forward(340)
    turtle.end_fill()
    turtle.pu()
    turtle.pencolor("black")
    for i in range(10):
        turtle.goto(30+i*i,-59.5)
        turtle.pd()
        turtle.dot(5)





# 画身体
def shenti():
    turtle.pu()
    turtle.seth(90)
    turtle.goto(100,-45)
    turtle.pensize(1)
    turtle.fillcolor(255,255,96)
    turtle.pd()
    turtle.begin_fill()
    turtle.circle(30,360)
    turtle.end_fill()


# 画左脚
def left(x,y):
    turtle.pu()
    turtle.goto(x,y)
    turtle.seth(195)
    turtle.pd()
    turtle.forward(15)



# 画右脚
def right(x,y):
    turtle.pu()
    turtle.goto(x,y)
    turtle.pd()
    turtle.seth(165)
    turtle.forward(15)


# 画头
def bgpic():

    yun(42,205)
    zhalan_all()
    dimian()
    shenti()
    left(90,-43)
    right(105,-45)

def head(x,y):
    turtle.pu()
    turtle.seth(330)
    turtle.goto(x,y)
    turtle.pd()
    turtle.fillcolor(255,255,96)
    turtle.begin_fill()
    turtle.circle(15,360)
    turtle.end_fill()


# 画嘴
def mouth(x,y):
    turtle.pu()
    turtle.goto(x,y)
    turtle.pd()
    turtle.fillcolor(192,96,48)
    turtle.begin_fill()
    turtle.seth(165)
    turtle.forward(18)
    turtle.seth(15)
    turtle.forward(18)
    turtle.end_fill()


# 画眼睛
def eye(x,y):
    turtle.pu()
    turtle.seth(90)
    turtle.goto(x,y)
    turtle.fillcolor(0,0,0)
    turtle.begin_fill()
    turtle.pd()
    turtle.circle(1,360)
    turtle.end_fill()



# 低头
def ditou():
    print "ditou"
    turtle.clear()
    bgpic()
    head(68,-21)
    mouth(51,-42)
    eye(52,-30)
    turtle.hideturtle()
    turtle.update()

# 抬头
def taitou():
    print "taitou"
    turtle.clear()
    bgpic()
    head(68,-10)
    mouth(47,-31)
    eye(53,-15)
    turtle.hideturtle()
    turtle.update()



taitou()

# 按键交互
turtle.onkeypress(ditou, 'space')
turtle.onkeyrelease(taitou, 'space')
turtle.listen()
turtle.done()

  </textarea>
  <button onclick="runit()" type="button">Run</button>
    </div>

    <div class="col-lg">
      <div id="mycanvas" height="100%" width="100%" style="border-style: solid;"></div>
    </div>
  </div>
</div>
  <script>
    function runit() {
      var prog = document.getElementById("code").value;
      if (prog.indexOf('turtle.mode("logo")') < 0) {
        prog = prog.replace('import turtle', 'import turtle\nturtle.mode("logo")\nturtle.seth(0)')
      } else  {
        prog = prog.replace('turtle.mode("logo")', 'turtle.mode("logo")\nturtle.seth(0)')
      }
      // console.log(prog);
      function builtinRead(x) {
        if (Sk.builtinFiles === undefined || Sk.builtinFiles["files"][x] === undefined)
          throw "File not found: '" + x + "'";
        return Sk.builtinFiles["files"][x];
      }
      (Sk.TurtleGraphics || (Sk.TurtleGraphics = {})).target = 'mycanvas';

      Sk.configure({
        read: builtinRead
      });

      Sk.misceval.asyncToPromise(function() {
        return Sk.importMainWithBody("<stdin>", false, prog, true);
      });
    }
  </script>
</body>

</html>
